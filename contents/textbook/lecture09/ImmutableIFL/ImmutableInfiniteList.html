<!DOCTYPE html>
<html>

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="MarkBind 2.14.1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CS2030 AY19/20 Semester 2</title>
  <link rel="stylesheet" href="../../../../markbind/css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../../markbind/css/bootstrap-vue.min.css">
  <link rel="stylesheet" href="../../../../markbind/fontawesome/css/all.min.css">
  <link rel="stylesheet" href="../../../../markbind/glyphicons/css/bootstrap-glyphicons.min.css">
  <link rel="stylesheet" href="../../../../markbind/css/octicons.css">
  <link rel="stylesheet" href="../../../../markbind/css/github.min.css">
  <link rel="stylesheet" href="../../../../markbind/css/markbind.css">
  <link rel="stylesheet" href="/1920-s2/plugins/markbind-plugin-anchors/markbind-plugin-anchors.css">
  <link rel="stylesheet" href="../../../../markbind/layouts/default/styles.css">
  <link rel="stylesheet" href="../../../../markbind/css/page-nav.css">
</head>

<body data-spy="scroll" data-target="#page-nav" data-offset="100">
  <div id="app">
    <header>
      <navbar type="dark" class="temp-navbar">
        <a slot="brand" href="/1920-s2/index.html" title="Home" class="navbar-brand">CS2030 AY19/20 Semester 2</a>
        <div class="nav-link temp-dropdown-placeholder">Peer Learning</div>
        <dropdown class="nav-link temp-dropdown"><template slot="_header">Peer Learning</template>
          <li><a href="/1920-s2/contents/peerlearning/peerlearning.html" class="dropdown-item">Introduction</a></li>
          <li><a href="/1920-s2/contents/peerlearning/textbook.html" class="dropdown-item">Textbook Contributions</a></li>
          <li><a href="/1920-s2/contents/peerlearning/peerlearningtask.html" class="dropdown-item">Peer Learning Tasks</a></li>
          <li><a href="/1920-s2/contents/peerlearning/piazza.html" class="dropdown-item">Piazza Participation</a></li>
        </dropdown>
        <div class="nav-link temp-dropdown-placeholder">Guides</div>
        <dropdown class="nav-link temp-dropdown"><template slot="_header">Guides</template>
          <li><a href="/1920-s2/contents/guides/settingUpLabEnv.html" class="dropdown-item">Setting Up Lab Environment</a></li>
          <li><a href="/1920-s2/contents/guides/settingUpJava.html" class="dropdown-item">Setting Up Java</a></li>
          <li><a href="/1920-s2/contents/guides/settingUpVim.html" class="dropdown-item">Setting Up Vim</a></li>
          <li><a href="/1920-s2/contents/guides/settingUpMacVim.html" class="dropdown-item">Setting Up MacVim</a></li>
          <li><a href="/1920-s2/contents/guides/sunfireLabs.html" class="dropdown-item">Setting Up Sunfire and PE Nodes</a></li>
          <li><a href="/1920-s2/contents/guides/settingUpCheckstyle.html" class="dropdown-item">Setting Up Checkstyle</a></li>
        </dropdown>
        <li><a slot="brand" href="/1920-s2/contents/textbook/textbook.html" class="nav-link">Textbook</a></li>
        <div class="nav-link temp-dropdown-placeholder">Links</div>
        <dropdown class="nav-link temp-dropdown"><template slot="_header">Links</template>
          <li><a href="https://www.comp.nus.edu.sg/~cs2030/style/" class="dropdown-item" target="_blank">CS2030 Java Style Guide</a></li>
          <li><a href="https://www.comp.nus.edu.sg/~cs2030/javadoc/" class="dropdown-item" target="_blank">CS2030 Javadoc Specification</a></li>
          <li><a href="https://www.oracle.com/technetwork/java/javase/downloads/jdk11-downloads-5066655.html" class="dropdown-item" target="_blank">JDK 11 Download Link</a></li>
          <li><a href="https://codecrunch.comp.nus.edu.sg/" class="dropdown-item" target="_blank">Codecrunch</a></li>
          <li><a href="https://github.com/nus-cs2030/1920-s2" class="dropdown-item" target="_blank">Github Repo</a></li>
          <li><a href="https://piazza.com/class/k54zo22zq1t2zc" class="dropdown-item" target="_blank">Piazza Forum</a></li>
        </dropdown>
        <li slot="right">
          <form class="navbar-form">
            <searchbar :data="searchData" placeholder="Search" :on-hit="searchCallback" menu-align-right></searchbar>
          </form>
        </li>
      </navbar>
    </header>
    <div id="flex-body">

      <div id="content-wrapper">
        <br>
        <h1 id="immutable-infinite-list-and-mutable-infinite-list">Immutable Infinite List And Mutable Infinite List<a class="fa fa-anchor" href="#immutable-infinite-list-and-mutable-infinite-list" onclick="event.stopPropagation()"></a></h1>

        <p><a href="https://github.com/nus-cs2030/1920-s2/edit/master/contents/textbook/lecture09/ImmutableIFL/ImmutableInfiniteList.md">Edit the material here! <span aria-hidden="true" class="fas fa-pen"></span></a></p>

        <p>In Lecture 9, We learnt to appreciate the laziness of Streams by designing our own infinite list.</p>
        <h2 id="mutable-infinite-list-implementation-1">Mutable Infinite List(Implementation 1)<a class="fa fa-anchor" href="#mutable-infinite-list-implementation-1" onclick="event.stopPropagation()"></a></h2>
        <ol>
          <li>An InfiniteList is a generic list that can store elements of type T in order where duplicates are allowed. InfiniteList is defined as an interface, and then each operation on an infinite list is implemented as a class that implements the InfiniteList interface.</li>
          <li>The InfiniteList interface has an abstract get() method, which is used to obtain the next element from the infinite list. The key to implementing an intermediate operation on the infinite list is to override the get() method, and implement the logic of each method in its body.</li>
        </ol>
        <h4 id="let-us-create-a-mutable-infinite-list-infinitelistimpl-abstract-class-which-implements-infinitelist">Let us create a mutable infinite list (InfiniteListImpl abstract class) which implements InfiniteList<t></t><a class="fa fa-anchor" href="#let-us-create-a-mutable-infinite-list-infinitelistimpl-abstract-class-which-implements-infinitelist" onclick="event.stopPropagation()"></a></h4>
        <h4 id="infinitelist-t-class-contains-the-abstract-classes-of-all-operations-that-will-later-be-defined-in-infinitelistimplt-and-also-an-abstract-method-get">InfiniteList&lt; T &gt; class contains the abstract classes of all operations that will later be defined in InfiniteListImpl&lt;T&gt; and also an abstract method get()<a class="fa fa-anchor" href="#infinitelist-t-class-contains-the-abstract-classes-of-all-operations-that-will-later-be-defined-in-infinitelistimplt-and-also-an-abstract-method-get" onclick="event.stopPropagation()"></a></h4>
        <h4 id="infinitelistimpl-t-is-an-abstract-class-because-it-does-not-implement-the-get-method-that-will-implement-the-immediate-operations-by-override-the-get-method-and-implementing-the-logic-in-the-method-body">InfiniteListImpl &lt; T &gt; is an abstract class(Because it does not implement the get() method) that will implement the immediate operations by override the get() method and implementing the logic in the method body<a class="fa fa-anchor" href="#infinitelistimpl-t-is-an-abstract-class-because-it-does-not-implement-the-get-method-that-will-implement-the-immediate-operations-by-override-the-get-method-and-implementing-the-logic-in-the-method-body" onclick="event.stopPropagation()"></a></h4>
        <h2 id="immutable-infinite-list-implementation-2">Immutable Infinite List(Implementation 2)<a class="fa fa-anchor" href="#immutable-infinite-list-implementation-2" onclick="event.stopPropagation()"></a></h2>
        <ol>
          <li>An infinite list (when not empty) contains a head value and a tail list.</li>
          <li>To make an infinite list be processed like a Stream, we can store the methods that are applicable to the infinite list in an IFL interface and create a class which implements the interface but behaves like a Stream, in a delayed manner.</li>
        </ol>
        <h5 id="let-s-create-an-immutable-class-which-implements-ifl-iflimpl-t">Let’s create an immutable class which implements IFL<t>: IFLImpl&lt; T &gt;</t><a class="fa fa-anchor" href="#let-s-create-an-immutable-class-which-implements-ifl-iflimpl-t" onclick="event.stopPropagation()"></a></h5>
        <h5 id="iflimpl-t-contains">IFLImpl&lt; T &gt; contains:<a class="fa fa-anchor" href="#iflimpl-t-contains" onclick="event.stopPropagation()"></a></h5>
        <h5 id="a-head-supplieroptionalt">- A Head (<code>Supplier&lt;Optional&lt;T&gt;&gt;</code>)<a class="fa fa-anchor" href="#a-head-supplieroptionalt" onclick="event.stopPropagation()"></a></h5>
        <h5 id="gives-the-current-value-when-supplier-s-get-method-is-called">-&gt; Gives the current value when Supplier’s get() method is called.<a class="fa fa-anchor" href="#gives-the-current-value-when-supplier-s-get-method-is-called" onclick="event.stopPropagation()"></a></h5>
        <h5 id="o">( ) -&gt; O<a class="fa fa-anchor" href="#o" onclick="event.stopPropagation()"></a></h5>
        <h5 id="a-tail-supplieriflimplt">- A Tail (<code>Supplier&lt;IFLImpl&lt;T&gt;&gt;</code>)<a class="fa fa-anchor" href="#a-tail-supplieriflimplt" onclick="event.stopPropagation()"></a></h5>
        <h5 id="gives-another-iflimpl-when-supplier-s-get-method-is-called">-&gt; Gives another IFLImpl when Supplier’s get() method is called.<a class="fa fa-anchor" href="#gives-another-iflimpl-when-supplier-s-get-method-is-called" onclick="event.stopPropagation()"></a></h5>
        <h5 id="oooo">( ) -&gt; OOOO<a class="fa fa-anchor" href="#oooo" onclick="event.stopPropagation()"></a></h5>
        <p><a href="https://postimg.cc/pmMZwDvZ"><a href="https://i.postimg.cc/8zj0rHnq/Infinite-List-Diagram.png" target="_self"><img src="https://i.postimg.cc/8zj0rHnq/Infinite-List-Diagram.png" alt class="img-fluid"></a></a></p>
        <h6 id="figure-1-an-infinite-list-with-a-head-and-a-tail-infinite-list-which-gives-another-head-and-tail-infinite-list">Figure 1. An Infinite List with a head and a tail Infinite List which gives another head and tail Infinite List…<a class="fa fa-anchor" href="#figure-1-an-infinite-list-with-a-head-and-a-tail-infinite-list-which-gives-another-head-and-tail-infinite-list" onclick="event.stopPropagation()"></a></h6>
        <p>Both head and tail are Suppliers so that production of data can be delayed. Suppliers signal the intention that you want to do the action but not yet till you call Supplier’s get() method. Both head and tail should be made ‘<strong>private final</strong>’ in the spirit of Immutability.</p>
        <h3 id="stream-operations">Stream Operations<a class="fa fa-anchor" href="#stream-operations" onclick="event.stopPropagation()"></a></h3>
        <p>Different operations will be represented by different IFLImpl with its own customized operations on the head and tail. Additionally, every data source/ intermediate operation will generate a new node (IFLImpl) because here we are trying to make the nodes immutable rather than update the node.
          <br></p>
        <h3 id="data-source-operations">Data Source Operations<a class="fa fa-anchor" href="#data-source-operations" onclick="event.stopPropagation()"></a></h3>
        <h4 id="generate">Generate<a class="fa fa-anchor" href="#generate" onclick="event.stopPropagation()"></a></h4>
        <h5 id="implementation-1-mutable">Implementation 1(Mutable)<a class="fa fa-anchor" href="#implementation-1-mutable" onclick="event.stopPropagation()"></a></h5>
        <pre><code class="hljs java"><span><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">InfiniteListImpl&lt;T&gt; <span class="hljs-title">generate</span><span class="hljs-params">(Supplier&lt;? extends T&gt; supplier)</span> </span>{<br></span><span>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> InfiniteListImpl&lt;T&gt;() {<br></span><span>            <span class="hljs-function"><span class="hljs-keyword">public</span> Optional&lt;T&gt; <span class="hljs-title">get</span><span class="hljs-params">()</span> </span>{<br></span><span>                <span class="hljs-keyword">return</span> Optional.of(supplier.get());<br></span><span>            }<br></span><span>        };<br></span><span>}<br></span></code></pre>
        <h5 id="implementation-2-immutable">Implementation 2(Immutable)<a class="fa fa-anchor" href="#implementation-2-immutable" onclick="event.stopPropagation()"></a></h5>
        <pre><code class="hljs java"><span><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">IFLImpl&lt;T&gt; <span class="hljs-title">generate</span><span class="hljs-params">(Supplier&lt;T&gt; supplier)</span> </span>{<br></span><span>	Supplier&lt;Optional&lt;T&gt;&gt; newHead = () -&gt; Optional.of(supplier.get());<br></span><span>	Supplier&lt;IFLImpl&lt;T&gt;&gt; newTail = () -&gt; IFLImpl.generate(supplier);<br></span><span>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> IFLImpl&lt;T&gt;(newHead, newTail);<br></span><span>}<br></span></code></pre>
        <h4 id="iterate">Iterate<a class="fa fa-anchor" href="#iterate" onclick="event.stopPropagation()"></a></h4>
        <h5 id="implementation-1-mutable-2">Implementation 1(Mutable)<a class="fa fa-anchor" href="#implementation-1-mutable-2" onclick="event.stopPropagation()"></a></h5>
        <pre><code class="hljs java"><span><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">InfiniteListImpl&lt;T&gt; <span class="hljs-title">iterate</span><span class="hljs-params">(T seed, UnaryOperator&lt;T&gt; f)</span> </span>{<br></span><span>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> InfiniteListImpl&lt;T&gt;() {<br></span><span>            <span class="hljs-keyword">private</span> T element = seed;<br></span><span>            <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> firstEle = <span class="hljs-keyword">true</span>;<br></span><span><br></span><span>            <span class="hljs-function"><span class="hljs-keyword">public</span> Optional&lt;T&gt; <span class="hljs-title">get</span><span class="hljs-params">()</span> </span>{<br></span><span>                <span class="hljs-keyword">if</span> (firstEle) {<br></span><span>                    firstEle = <span class="hljs-keyword">false</span>;<br></span><span>                } <span class="hljs-keyword">else</span> {<br></span><span>                    element = f.apply(element);<br></span><span>                }<br></span><span>                <span class="hljs-keyword">return</span> Optional.of(element);<br></span><span>            }<br></span><span>        };<br></span><span>}<br></span></code></pre>
        <h5 id="implementation-2-immutable-2">Implementation 2(Immutable)<a class="fa fa-anchor" href="#implementation-2-immutable-2" onclick="event.stopPropagation()"></a></h5>
        <pre><code class="hljs java"><span><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">IFLImpl&lt;T&gt; <span class="hljs-title">iterate</span><span class="hljs-params">(T seed, Function&lt;T, T&gt; next)</span> </span>{<br></span><span>	Supplier&lt;Optional&lt;T&gt;&gt; newHead = () -&gt; Optional.of(seed);<br></span><span>	Supplier&lt;IFLImpl&lt;T&gt;&gt; newTail = () -&gt; IFLImpl.iterate(next.apply(seed), next);<br></span><span>	<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> IFLImpl&lt;T&gt;(newHead, newTail);<br></span><span>}<br></span></code></pre>
        <p>Next seed is obtained via <code>next.apply(seed)</code>
          <br></p>
        <h3 id="intermediate-operations">Intermediate Operations<a class="fa fa-anchor" href="#intermediate-operations" onclick="event.stopPropagation()"></a></h3>
        <h4 id="map">Map<a class="fa fa-anchor" href="#map" onclick="event.stopPropagation()"></a></h4>
        <h5 id="implementation-1-mutable-3">Implementation 1(Mutable)<a class="fa fa-anchor" href="#implementation-1-mutable-3" onclick="event.stopPropagation()"></a></h5>
        <pre><code class="hljs java"><span><span class="hljs-keyword">public</span> &lt;S&gt; <span class="hljs-function">InfiniteList&lt;S&gt; <span class="hljs-title">map</span><span class="hljs-params">(Function&lt;? <span class="hljs-keyword">super</span> T, ? extends S&gt; mapper)</span> </span>{<br></span><span>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> InfiniteListImpl&lt;S&gt;() {<br></span><span>            <span class="hljs-function"><span class="hljs-keyword">public</span> Optional&lt;S&gt; <span class="hljs-title">get</span><span class="hljs-params">()</span> </span>{<br></span><span>                <span class="hljs-keyword">return</span> InfiniteListImpl.<span class="hljs-keyword">this</span>.get().map(mapper);<br></span><span>            }<br></span><span>        };<br></span><span>    }<br></span></code></pre>
        <h5 id="implementation-2-immutable-3">Implementation 2(Immutable)<a class="fa fa-anchor" href="#implementation-2-immutable-3" onclick="event.stopPropagation()"></a></h5>
        <pre><code class="hljs java"><span><span class="hljs-keyword">public</span> &lt;R&gt; <span class="hljs-function">IFLImpl&lt;R&gt; <span class="hljs-title">map</span><span class="hljs-params">(Function&lt;T,R&gt; mapper)</span> </span>{<br></span><span>	Supplier&lt;Optional&lt;T&gt;&gt; newHead = () -&gt; IFLImpl.<span class="hljs-keyword">this</span>.head.get().map(mapper);<br></span><span>	Supplier&lt;IFLImpl&lt;T&gt;&gt; newTail = () -&gt; IFLImpl.<span class="hljs-keyword">this</span>.tail.get().map(mapper);<br></span><span>	<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> IFLImpl&lt;T&gt;(newHead, newTail);<br></span><span>}<br></span></code></pre>
        <p>Map returns a new IFLImpl object with the head supplier that</p>
        <ul>
          <li>is triggered by a terminal operation (e.g. forEach) at the end of the stream pipeline</li>
          <li>gets the element upstream from the data source through IFLImpl.this.head.get()</li>
          <li>apply the mapper function to the element obtained to get a mapped element</li>
        </ul>
        <h4 id="filter">Filter<a class="fa fa-anchor" href="#filter" onclick="event.stopPropagation()"></a></h4>
        <h5 id="implementation-1-mutable-4">Implementation 1(Mutable)<a class="fa fa-anchor" href="#implementation-1-mutable-4" onclick="event.stopPropagation()"></a></h5>
        <pre><code class="hljs java"><span><span class="hljs-function"><span class="hljs-keyword">public</span> InfiniteList&lt;T&gt; <span class="hljs-title">filter</span><span class="hljs-params">(Predicate&lt;? <span class="hljs-keyword">super</span> T&gt; predicate)</span> </span>{<br></span><span>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> InfiniteListImpl&lt;T&gt;() {<br></span><span>            <span class="hljs-function"><span class="hljs-keyword">public</span> Optional&lt;T&gt; <span class="hljs-title">get</span><span class="hljs-params">()</span> </span>{<br></span><span>                Optional&lt;T&gt; element = InfiniteListImpl.<span class="hljs-keyword">this</span>.get();<br></span><span>                <span class="hljs-keyword">while</span> (element.isPresent() &amp;&amp; !element.filter(predicate).isPresent()) {<br></span><span>                    element = InfiniteListImpl.<span class="hljs-keyword">this</span>.get();<br></span><span>                }<br></span><span>                <span class="hljs-keyword">return</span> element;<br></span><span>            }<br></span><span>        };<br></span><span>}<br></span></code></pre>
        <h5 id="implementation-2-immutable-4">Implementation 2(Immutable)<a class="fa fa-anchor" href="#implementation-2-immutable-4" onclick="event.stopPropagation()"></a></h5>
        <pre><code class="hljs java"><span><span class="hljs-function"><span class="hljs-keyword">public</span> IFLImpl&lt;T&gt; <span class="hljs-title">filter</span><span class="hljs-params">(Predicate&lt;T&gt; predicate)</span> </span>{<br></span><span>	Supplier&lt;Optional&lt;T&gt;&gt; newHead = () -&gt; IFLImpl.<span class="hljs-keyword">this</span>.head.get().filter(predicate);<br></span><span>	Supplier&lt;IFLImpl&lt;T&gt;&gt; newTail = () -&gt; IFLImpl.<span class="hljs-keyword">this</span>.tail.get().filter(predicate);<br></span><span>	<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> IFLImpl&lt;T&gt;(newHead, newTail);<br></span><span>}<br></span></code></pre>
        <p>Optional is used to deal with the missing values<br>
          -&gt; If a value is present, and the value matches the given predicate, an Optional describing the value is returned.<br>
          -&gt; Otherwise, an empty Optional is returned.</p>
        <h4 id="limit-state-not-maintained-in-the-spirit-of-immutability">Limit (state not maintained in the spirit of Immutability)<a class="fa fa-anchor" href="#limit-state-not-maintained-in-the-spirit-of-immutability" onclick="event.stopPropagation()"></a></h4>
        <h5 id="implementation-1-mutable-5">Implementation 1(Mutable)<a class="fa fa-anchor" href="#implementation-1-mutable-5" onclick="event.stopPropagation()"></a></h5>
        <pre><code class="hljs java"><span><span class="hljs-function"><span class="hljs-keyword">public</span> InfiniteListImpl&lt;T&gt; <span class="hljs-title">limit</span><span class="hljs-params">(<span class="hljs-keyword">long</span> maxSize)</span> </span>{<br></span><span>        <span class="hljs-keyword">if</span> (maxSize &lt; <span class="hljs-number">0</span>) {<br></span><span>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(String.valueOf(maxSize));<br></span><span>        }<br></span><span>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> InfiniteListImpl&lt;T&gt;() {<br></span><span>            <span class="hljs-keyword">private</span> <span class="hljs-keyword">long</span> max = maxSize;<br></span><span>            <span class="hljs-function"><span class="hljs-keyword">public</span> Optional&lt;T&gt; <span class="hljs-title">get</span><span class="hljs-params">()</span> </span>{<br></span><span>                <span class="hljs-keyword">if</span> (max &lt; <span class="hljs-number">1</span>) {<br></span><span>                    <span class="hljs-keyword">return</span> Optional.empty();<br></span><span>                } <span class="hljs-keyword">else</span> {<br></span><span>                    max--;<br></span><span>                    <span class="hljs-keyword">return</span> InfiniteListImpl.<span class="hljs-keyword">this</span>.get();<br></span><span>                }<br></span><span>            }<br></span><span>        };<br></span><span>}<br></span></code></pre>
        <h5 id="implementation-2">Implementation 2<a class="fa fa-anchor" href="#implementation-2" onclick="event.stopPropagation()"></a></h5>
        <p>We can create an EmptyList class with an isEmpty() method that checks whether an infinite list is empty so that the terminal operations know when to stop the stream pipeline operation.</p>
        <pre><code class="hljs java"><span><span class="hljs-function"><span class="hljs-keyword">public</span> IFLImpl&lt;T&gt; <span class="hljs-title">limit</span><span class="hljs-params">(<span class="hljs-keyword">long</span> n)</span> </span>{<br></span><span>    <span class="hljs-keyword">if</span> (n &lt;= <span class="hljs-number">0</span> || isEmpty()) {<br></span><span>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> EmptyList&lt;&gt;();<br></span><span>    }<br></span><span>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> IFLImpl&lt;T&gt;(head, () -&gt; { <br></span><span>        <span class="hljs-keyword">if</span> (n == <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> head.get().isPresent()<br></span><span>            ? <span class="hljs-keyword">new</span> EmptyList&lt;&gt;()<br></span><span>            : tail.get().limit(n);<br></span><span>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> head.get().isPresent()<br></span><span>            ? tail.get().limit(n - <span class="hljs-number">1</span>)<br></span><span>            : tail.get().limit(n);<br></span><span>    });<br></span><span>}<br></span></code></pre><br>
        <h3 id="terminal-operations">Terminal Operations<a class="fa fa-anchor" href="#terminal-operations" onclick="event.stopPropagation()"></a></h3>
        <h4 id="foreach">ForEach<a class="fa fa-anchor" href="#foreach" onclick="event.stopPropagation()"></a></h4>
        <h5 id="implementation-1-mutable-6">Implementation 1(Mutable)<a class="fa fa-anchor" href="#implementation-1-mutable-6" onclick="event.stopPropagation()"></a></h5>
        <pre><code class="hljs java"><span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">forEach</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-keyword">super</span> T&gt; action)</span> </span>{<br></span><span>        Optional&lt;T&gt; curr = get();<br></span><span>        <span class="hljs-keyword">while</span> (curr.isPresent()) {<br></span><span>            action.accept(curr.get());<br></span><span>            curr = get();<br></span><span>        }<br></span><span>}<br></span></code></pre>
        <h5 id="implementation-2-immutable-5">Implementation 2(Immutable)<a class="fa fa-anchor" href="#implementation-2-immutable-5" onclick="event.stopPropagation()"></a></h5>
        <pre><code class="hljs java"><span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">forEach</span><span class="hljs-params">(Consumer&lt;T&gt; action)</span> </span>{<br></span><span>	IFLImpl&lt;T&gt; curr = <span class="hljs-keyword">this</span>;<br></span><span>	<span class="hljs-keyword">while</span>(<span class="hljs-keyword">true</span>) {<br></span><span>		current.head.get().ifPresent(x -&gt; action.accept(x));<br></span><span>		curr = current.tail.get();<br></span><span>	}<br></span><span>}<br></span></code></pre>
        <ul>
          <li><code>current.head.get()</code> invokes the head supplier to get an element</li>
          <li><code>curr.tail.get()</code> will call iter which will return a new IFL</li>
          <li>forEach needs a reference to maintain what it is currently looking at, so we give it a current pointer (curr) that is originally pointing to itself and will refer to a new IFLImpl object everytime it is called</li>
          <li>forEach will call the newest node that has been generated</li>
        </ul>
        <h4 id="reduce">Reduce<a class="fa fa-anchor" href="#reduce" onclick="event.stopPropagation()"></a></h4>
        <h5 id="implementation-1-mutable-7">Implementation 1(Mutable)<a class="fa fa-anchor" href="#implementation-1-mutable-7" onclick="event.stopPropagation()"></a></h5>
        <pre><code class="hljs java"><span><span class="hljs-function"><span class="hljs-keyword">public</span> T <span class="hljs-title">reduce</span><span class="hljs-params">(T identity, BinaryOperator&lt;T&gt; accumulator)</span> </span>{<br></span><span>    Optional&lt;T&gt; tmp1 = Optional.of(identity);<br></span><span>    Optional&lt;T&gt; tmp2 = InfiniteListImpl.<span class="hljs-keyword">this</span>.get();<br></span><span><br></span><span>    <span class="hljs-keyword">while</span> (tmp2.isPresent()) {<br></span><span>        tmp1 = Optional.of(accumulator.apply(tmp1.get(), tmp2.get()));<br></span><span>        tmp2 = InfiniteListImpl.<span class="hljs-keyword">this</span>.get();<br></span><span>    }<br></span><span><br></span><span>    <span class="hljs-keyword">return</span> tmp1.get();<br></span><span>}<br></span></code></pre>
        <h5 id="implementation-2-immutable-6">Implementation 2(Immutable)<a class="fa fa-anchor" href="#implementation-2-immutable-6" onclick="event.stopPropagation()"></a></h5>
        <pre><code class="hljs java"><span><span class="hljs-keyword">public</span> &lt;U&gt; <span class="hljs-function">U <span class="hljs-title">reduce</span><span class="hljs-params">(U identity, BiFunction&lt;U, ? <span class="hljs-keyword">super</span> T, U&gt; accumulator)</span> </span>{<br></span><span>    U temp = identity;<br></span><span>    InfiniteListImpl&lt;T&gt; tmp = <span class="hljs-keyword">this</span>;<br></span><span>    <span class="hljs-keyword">while</span> (!(tmp <span class="hljs-keyword">instanceof</span> EmptyList)) {<br></span><span>        <span class="hljs-keyword">if</span> (tmp.head.get().isPresent()) {<br></span><span>            temp = accumulator.apply(temp, tmp.head.get().get();<br></span><span>        }<br></span><span>        tmp = tmp.tail.get();<br></span><span>    }<br></span><span>    <span class="hljs-keyword">return</span> temp;<br></span><span>}<br></span></code></pre>
        <ul>
          <li><code>tmp.head.get()</code> checks which head is not empty and invokes the head supplier to get an element</li>
          <li><code>tmp.tail.get()</code> will return a new InfiniteListImpl</li>
          <li>Reduce has a pointer(tmp) to keep track of what is currently being looked at, it refers to a new InfiniteListImpl during every iteration</li>
        </ul>
        <hr>
        <h3 id="important-concept"><strong>IMPORTANT CONCEPT</strong><a class="fa fa-anchor" href="#important-concept" onclick="event.stopPropagation()"></a></h3>
        <h3 id="variable-capture-using-java-memory-model">Variable Capture (Using Java Memory Model)<a class="fa fa-anchor" href="#variable-capture-using-java-memory-model" onclick="event.stopPropagation()"></a></h3>
        <p><a href="https://postimg.cc/4mQ73ttw"><a href="https://i.postimg.cc/8PqhtmC8/Variable-Capture.png" target="_self"><img src="https://i.postimg.cc/8PqhtmC8/Variable-Capture.png" alt class="img-fluid"></a></a></p>
        <h6 id="figure-2-model-when-ifl-iter-1-x-x-1-foreach-action-is-called-and-when-we-bring-map-into-the-picture">Figure 2. Model when IFL.iter(1, x -&gt; x+1).forEach(action) is called and when we bring map into the picture<a class="fa fa-anchor" href="#figure-2-model-when-ifl-iter-1-x-x-1-foreach-action-is-called-and-when-we-bring-map-into-the-picture" onclick="event.stopPropagation()"></a></h6>
        <ul>
          <li>Nodes don’t mutate throughout, a new IFL object is created</li>
          <li>Variables are captured within each IFL object created</li>
        </ul>
        <h4 id="process">Process:<a class="fa fa-anchor" href="#process" onclick="event.stopPropagation()"></a></h4>
        <ol>
          <li><code>IFL.iter(1, x -&gt; x + 1)</code> creates a new IFLImpliter1 object with its specified head and tail. The seed(1) and next(i) is captured by the new object.</li>
          <li>forEach(action) is called on the object created. ‘this’ points to the object and curr also point to the object and the forEach method will operate on the object and call iter (refer to forEach section for more details). The cycle repeats until there is no element to retrieve.</li>
          <li>If map is called, map will create a new IFLImplmap object with its specified head and tail. The previous object will be captured to get the element from the object to apply mapper to it.
            &lt;/T&gt;</li>
        </ol>
      </div>


      <nav id="page-nav" class="navbar navbar-light bg-transparent">
        <div class="border-left-grey nav-inner position-sticky slim-scroll">

          <nav class="nav nav-pills flex-column my-0 small no-flex-wrap">
            <a class="nav-link py-1" href="#immutable-infinite-list-and-mutable-infinite-list">Immutable Infinite List And Mutable Infinite List&#x200E;</a>
            <nav class="nav nav-pills flex-column my-0 nested no-flex-wrap">
              <a class="nav-link py-1" href="#mutable-infinite-list-implementation-1">Mutable Infinite List(Implementation 1)&#x200E;</a>
              <a class="nav-link py-1" href="#immutable-infinite-list-implementation-2">Immutable Infinite List(Implementation 2)&#x200E;</a>
            </nav>

          </nav>
        </div>
      </nav>
    </div>
    <footer>

      <div class="text-center">
        <small>Generated by <a href="https://markbind.org/">MarkBind 2.14.1</a> on Fri, May 8, 2020, 4:50:17 AM UTC</small></div>
    </footer>
  </div>
</body>
<script src="../../../../markbind/js/vue.min.js"></script>
<script src="../../../../markbind/js/vue-strap.min.js"></script>
<script src="../../../../markbind/js/bootstrap-utility.min.js"></script>
<script src="../../../../markbind/js/polyfill.min.js"></script>
<script src="../../../../markbind/js/bootstrap-vue.min.js"></script>
<script>
  const baseUrl = '/1920-s2'
  const enableSearch = true
</script>
<script src="../../../../markbind/js/setup.js"></script>
<script src="../../../../markbind/layouts/default/scripts.js"></script>

</html>