<!DOCTYPE html>
<html>

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="MarkBind 2.14.1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CS2030 AY19/20 Semester 2</title>
  <link rel="stylesheet" href="../../../../markbind/css/bootstrap.min.css">
  <link rel="stylesheet" href="../../../../markbind/css/bootstrap-vue.min.css">
  <link rel="stylesheet" href="../../../../markbind/fontawesome/css/all.min.css">
  <link rel="stylesheet" href="../../../../markbind/glyphicons/css/bootstrap-glyphicons.min.css">
  <link rel="stylesheet" href="../../../../markbind/css/octicons.css">
  <link rel="stylesheet" href="../../../../markbind/css/github.min.css">
  <link rel="stylesheet" href="../../../../markbind/css/markbind.css">
  <link rel="stylesheet" href="/1920-s2/plugins/markbind-plugin-anchors/markbind-plugin-anchors.css">
  <link rel="stylesheet" href="../../../../markbind/layouts/default/styles.css">
  <link rel="stylesheet" href="../../../../markbind/css/page-nav.css">
</head>

<body data-spy="scroll" data-target="#page-nav" data-offset="100">
  <div id="app">
    <header>
      <navbar type="dark" class="temp-navbar">
        <a slot="brand" href="/1920-s2/index.html" title="Home" class="navbar-brand">CS2030 AY19/20 Semester 2</a>
        <div class="nav-link temp-dropdown-placeholder">Peer Learning</div>
        <dropdown class="nav-link temp-dropdown"><template slot="_header">Peer Learning</template>
          <li><a href="/1920-s2/contents/peerlearning/peerlearning.html" class="dropdown-item">Introduction</a></li>
          <li><a href="/1920-s2/contents/peerlearning/textbook.html" class="dropdown-item">Textbook Contributions</a></li>
          <li><a href="/1920-s2/contents/peerlearning/peerlearningtask.html" class="dropdown-item">Peer Learning Tasks</a></li>
          <li><a href="/1920-s2/contents/peerlearning/piazza.html" class="dropdown-item">Piazza Participation</a></li>
        </dropdown>
        <div class="nav-link temp-dropdown-placeholder">Guides</div>
        <dropdown class="nav-link temp-dropdown"><template slot="_header">Guides</template>
          <li><a href="/1920-s2/contents/guides/settingUpLabEnv.html" class="dropdown-item">Setting Up Lab Environment</a></li>
          <li><a href="/1920-s2/contents/guides/settingUpJava.html" class="dropdown-item">Setting Up Java</a></li>
          <li><a href="/1920-s2/contents/guides/settingUpVim.html" class="dropdown-item">Setting Up Vim</a></li>
          <li><a href="/1920-s2/contents/guides/settingUpMacVim.html" class="dropdown-item">Setting Up MacVim</a></li>
          <li><a href="/1920-s2/contents/guides/sunfireLabs.html" class="dropdown-item">Setting Up Sunfire and PE Nodes</a></li>
          <li><a href="/1920-s2/contents/guides/settingUpCheckstyle.html" class="dropdown-item">Setting Up Checkstyle</a></li>
        </dropdown>
        <li><a slot="brand" href="/1920-s2/contents/textbook/textbook.html" class="nav-link">Textbook</a></li>
        <div class="nav-link temp-dropdown-placeholder">Links</div>
        <dropdown class="nav-link temp-dropdown"><template slot="_header">Links</template>
          <li><a href="https://www.comp.nus.edu.sg/~cs2030/style/" class="dropdown-item" target="_blank">CS2030 Java Style Guide</a></li>
          <li><a href="https://www.comp.nus.edu.sg/~cs2030/javadoc/" class="dropdown-item" target="_blank">CS2030 Javadoc Specification</a></li>
          <li><a href="https://www.oracle.com/technetwork/java/javase/downloads/jdk11-downloads-5066655.html" class="dropdown-item" target="_blank">JDK 11 Download Link</a></li>
          <li><a href="https://codecrunch.comp.nus.edu.sg/" class="dropdown-item" target="_blank">Codecrunch</a></li>
          <li><a href="https://github.com/nus-cs2030/1920-s2" class="dropdown-item" target="_blank">Github Repo</a></li>
          <li><a href="https://piazza.com/class/k54zo22zq1t2zc" class="dropdown-item" target="_blank">Piazza Forum</a></li>
        </dropdown>
        <li slot="right">
          <form class="navbar-form">
            <searchbar :data="searchData" placeholder="Search" :on-hit="searchCallback" menu-align-right></searchbar>
          </form>
        </li>
      </navbar>
    </header>
    <div id="flex-body">

      <div id="content-wrapper">
        <br>
        <h1 id="no-more-null">No more Null<a class="fa fa-anchor" href="#no-more-null" onclick="event.stopPropagation()"></a></h1>
        <hr>

        <p><a href="https://github.com/nus-cs2030/1920-s2/edit/master/contents/textbook/lecture07/Optional/Optional.md">Edit the material here! <span aria-hidden="true" class="fas fa-pen"></span></a></p>

        <h2 id="the-perils-of-null">The Perils of Null<a class="fa fa-anchor" href="#the-perils-of-null" onclick="event.stopPropagation()"></a></h2>
        <blockquote>
          <p>I call it my billion-dollar mistake. It was the invention of the null reference in 1965. At that time, I was designing the first comprehensive type system for references in an object oriented language (ALGOL W). My goal was to ensure that all use of references should be absolutely safe, with checking performed automatically by the compiler. But I couldn't resist the temptation to put in a null reference, simply because it was so easy to implement. This has led to innumerable errors, vulnerabilities, and system crashes, which have probably caused a billion dollars of pain and damage in the last forty years.</p>
          <p>-- <cite>Tony Hoare, inventor of ALGOL W</cite></p>
        </blockquote>
        <p>In Java, the <a href="https://docs.oracle.com/javase/specs/jls/se11/html/jls-3.html#jls-3.10.7">null literal</a> <code>null</code> represents the null reference, which is used to denote the non-existence of an object. Just like how primitive types take on a default value if declared but uninitialised (<code>int</code> takes on the value <code>0</code>, <code>boolean</code> takes on the value <code>false</code>, etc), uninitialised reference types take on the default value of <code>null</code>. Although the existence of null references might seem innocuous, it is the cause of many bugs written in programming languages without null safety.</p>
        <p>Java is a statically typed language, meaning that the types of all variables are known at compile time. This allows the Java compiler to catch certain bugs statically (before the program is run) rather than dynamically (during the execution of the program), thus providing certain guarantees about the behaviour of the program.</p>
        <p>For instance, let's say I have the following code:</p>
        <pre><code class="hljs"><span>Integer i = 2030;<br></span><span>i.toUpperCase();<br></span></code></pre>
        <p>Since <code>i</code> is of type <code>Integer</code>, the type check will fail and the code will not compile. By catching such errors during compile-time, static type checking helps immensely in the writing of large and complex programs.</p>
        <p>However, the use of null references results in a pitfall that is common to many programming languages. That is, accessing a member of a null reference will result in a null reference exception, known as a <code>NullPointerException</code> in Java.</p>
        <p>Take the below code for example:</p>
        <pre><code class="hljs"><span>String s = null;<br></span><span>s.toUpperCase();<br></span></code></pre>
        <p>It compiles without any issues, but throws a <code>NullPointerException</code> when run. While the cause of the bug might seem obvious here, <code>NullPointerException</code>s can be tricky to debug in large, complex software.</p>
        <h2 id="null-safety">Null Safety<a class="fa fa-anchor" href="#null-safety" onclick="event.stopPropagation()"></a></h2>
        <p>Null safety is a guarantee within an object-oriented programming language that no object references will have null or void values. This helps dramatically reduce the occurrence of <code>NullPointerException</code>s during the execution of programs.</p>
        <p>Certain languages such as Kotlin have <a href="https://kotlinlang.org/docs/reference/null-safety.html">null safety</a> built into the language. In Kotlin, the type system distinguishes between references that can hold null (nullable references) and those that cannot (non-null references). Calling a method or accessing a property on non-null references is guaranteed to always be safe. Should the programmer wish to use nullable references, they have to explicitly designate the variable as nullable.</p>
        <p>Kotlin also has a <a href="https://kotlinlang.org/docs/reference/null-safety.html#safe-calls">safe call operator</a>, which can be used to safely call a method or access a property on a reference without encountering a <code>NullPointerException</code>. The safe call checks if the reference is a null reference before evaluating the expression, returning <code>null</code> if called on a null reference.</p>
        <p>Although Java does not have null safety built into the language, and is unlikely to ever do so for backwards compatibility reasons, it is still possible to do away with nulls with the <code>Optional</code> class introduced in Java 8.</p>
        <h2 id="optional">Optional<a class="fa fa-anchor" href="#optional" onclick="event.stopPropagation()"></a></h2>
        <p>In lecture 7, we learn about the maybe class and using optional to hide the null and alse make the code more elegant by removing the need
          to check for null using if and else.</p>
        <p>In the lecture notes:</p>
        <pre><code class="hljs"><span>public class Maybe&lt;T&gt; {<br></span><span>  private final T thing;<br></span><span>  <br></span><span>  private Maybe() {<br></span><span>    thing = null;<br></span><span>  }<br></span><span>  <br></span><span>  public Maybe(T thing) {<br></span><span>    this.thing = thing;<br></span><span>  }<br></span><span>  <br></span><span>  public static &lt;T&gt; Maybe&lt;T&gt; empty() {<br></span><span>    return new Maybe&lt;T&gt;();<br></span><span>  }<br></span><span>  <br></span><span>  @Override<br></span><span>  public String toString() {<br></span><span>    return &quot;Maybe[&quot; + (thing == null ? &quot;empty&quot; : thing) + &quot;]&quot;;<br></span><span>  }<br></span><span>}<br></span></code></pre>
        <p>Instead of creating Maybe class, we can use java Optional class. When there is a null, the optional class will just contain the null
          like a box.</p>
        <p>Some useful methods include:
          1.of(T value)
          Putting the value in Optional</p>
        <p>2.empty()
          returning an Optional of empty</p>
        <p>3.ofNullable(T value)
          Returns an Optional containing the value if not null. Else, returns Optional that is empty.</p>
        <p>4.<code>flatMap(Function&lt;? super T,? extends Optional&lt;? extends U&gt;&gt; mapper)</code>
          Let's say you have a optional object in a optional object.
          flatMap is useful when you you want to get rid of the outer Optional casing of a Optional and inner optional, apply a given function,
          and putting it back into a Optional. The null will be passed on in the flatMap too and we do not need to
          check for null in every step.</p>
        <p>5.<code>map(Function&lt;? super T, ? extends U&gt; mapper)</code>
          Map just takes the value in one optional casing and apply the function and returns the Optional of the applied value.</p>
        <p>6.orElse(T other)
          returns value if present, else returns other.
          This is an alternative to the get() method.</p>
        <p>7.orElseThrow()
          for throwing NoSuchElementException</p>
        <p>8.<code>ifPresentOrElse(Consumer&lt;? super T&gt; action, Runnable emptyAction)</code>
          if value is present in the Optional, apply the action. or else perform the empty action.
          For example:</p>
        <pre><code class="hljs"><span>//from recitation screencast of lab 6:<br></span><span>Student addModule(String code, String name, String grade) {<br></span><span>  this.get(code)<br></span><span>    .ifPresentOrElse(<br></span><span>      m -&gt; m.addAssessment(name, grade),<br></span><span>      () -&gt; this.put(new Module(code).addAssessment(name,grade)<br></span><span>      );<br></span><span>  return this;<br></span><span>}<br></span></code></pre>
        <p>Example of the usage of methods of Optional class as shown in Lab 6 Roster class (adapted from the recitation screencast):</p>
        <pre><code class="hljs"><span>String getGrade(String id, String code, String name) throws NoSuchRecordException {<br></span><span>  return this.get(id)<br></span><span>    .flatMap(Student -&gt; student.get(code))<br></span><span>    .flatMap(module -&gt; module.get(name))<br></span><span>    .orElseThrow(() -&gt; new NoSuchRecordException(id, code, name))<br></span><span>    .getGrade();<br></span><span>}<br></span></code></pre>
        <p>Note: Avoid using methods such as get because it might invoke a NullPointerException. Also, do not use isPresent, isEmpty as it is
          equivalent of checking for null and it defeats the purpose of using the optional class.</p>
      </div>


      <nav id="page-nav" class="navbar navbar-light bg-transparent">
        <div class="border-left-grey nav-inner position-sticky slim-scroll">

          <nav class="nav nav-pills flex-column my-0 small no-flex-wrap">
            <a class="nav-link py-1" href="#no-more-null">No more Null&#x200E;</a>
            <nav class="nav nav-pills flex-column my-0 nested no-flex-wrap">
              <a class="nav-link py-1" href="#the-perils-of-null">The Perils of Null&#x200E;</a>
              <a class="nav-link py-1" href="#null-safety">Null Safety&#x200E;</a>
              <a class="nav-link py-1" href="#optional">Optional&#x200E;</a>
            </nav>

          </nav>
        </div>
      </nav>
    </div>
    <footer>

      <div class="text-center">
        <small>Generated by <a href="https://markbind.org/">MarkBind 2.14.1</a> on Sun, May 3, 2020, 2:02:30 AM UTC</small></div>
    </footer>
  </div>
</body>
<script src="../../../../markbind/js/vue.min.js"></script>
<script src="../../../../markbind/js/vue-strap.min.js"></script>
<script src="../../../../markbind/js/bootstrap-utility.min.js"></script>
<script src="../../../../markbind/js/polyfill.min.js"></script>
<script src="../../../../markbind/js/bootstrap-vue.min.js"></script>
<script>
  const baseUrl = '/1920-s2'
  const enableSearch = true
</script>
<script src="../../../../markbind/js/setup.js"></script>
<script src="../../../../markbind/layouts/default/scripts.js"></script>

</html>